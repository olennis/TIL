# 프로젝트 롤백을 해야 할 때

## 들어가기 전에

- lms 서비스를 새로 배포 하려고 모든 버전을 main 브랜치에 올려 놓은 상태였다. 하지만 배포단계에서 배포를 조금 미루자는 판단이 내려져 롤백을 결정했고, main 브랜치에 올라가 있던 코드들을 배포 전으로 돌려야 하는 상황이었다. 깃쫄보인 나에게는 하나하나 조심히 다뤄야 하는 부분이었지만, 이것을 통해서 깃 플로우를 조금이나마 익힌 것 같아서 기록으로 남기려 한다.

### reset

- 커밋을 특정 사건으로 표현할 때, reset은 이 특정 사건이 일어나기 전으로 돌린다. 즉 커밋을 아예 지워버리고, 과거의 이력이 남지 않는다. reset은
  - soft : index보존(add 한 상태), 워킹 디렉터리 파일 보존
  - mixed : index취소(add 하기 전 상태),워킹 디렉터리 파일 보존
  - hard : index취소(add 하기 전 상태), 워킹 디렉터리 파일 삭제 -> 모두 취소
    의 옵션이 있는데, 나의 경우에는

```js
git reset --hard [커밋번호]
```

의 명령어를 통해 reset 을 진행했다.

이렇게 reset을 진행하게 되면 원격의 저장소와 로컬의 저장소 간 차이가 생기게 된다.
원격 : 배포 된 상태의 코드
로컬 : reset으로 배포 되기 전 코드

이 차이를 덮어주기 위해 로컬에서

```js
git push origin main -f
```

로 force 옵션과 같이 push 했다. (로컬에서는 아직 수정이력이 남아있는 상태다. 이 부분은 나중에 git pull을 받아오면 해결이 되지 않을까 하고 고민하고 있다.)

main 브랜치에서는 어차피 과거의 이력이 남을 필요가 없기 때문에, 깔끔하게 밀어버리는 판단을 했고 (사실 아직도 내가 제대로 한건지 모르겠다. 이상한거 날렸으면 우짜지) 원격에서 확인을 할 때는 일단 배포 전으로 돌아가긴 했다. 혹시 커밋이 꼬인것은 나중의 문제기 때문에.. 꼬였다면 나중의 내가 열심히 해결하겠지.

### revert

- revert는 돌리고 싶은 커밋의 반대되는 커밋을 새로 생성
- 과거로 돌리는 느낌보다는 수정한 작업을 다시 수정하는 느낌
- --no-commit 옵션을 사용하게 되면 revert 할 때마다 커밋을 생성하지 않을 수 있음
